{"version":3,"sources":["usage.js"],"names":[],"mappings":";;AAEA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,UAAU,QAAQ,SAAR,CAAd;AACA,IAAI,OAAO,QAAQ,QAAR,CAAX;;;;AAKA,IAAI,YAAY;AACZ,iBAAa;AACT,sBAAc;AACV,gBAAI,cADM,E;AAEV,iBAAK,6CAFK;AAGV,uBAAW,QAHD;AAIV,kBAAM;AAJI;AADL;AADD,CAAhB;;;;AAcA,IAAI,kBAAkB,UAAU,EAAV,EAAc,QAAd,EAAwB;;AAE1C,WAAO,SAAS,IAAT,EAAe,UAAU,WAAV,CAAsB,EAAtB,CAAf,CAAP;AACH,CAHD;;;;AAQA,IAAI,UAAU,UAAU,GAAV,EAAe,GAAf,EAAoB;;AAE9B,SAAK,MAAL,CAAY,YAAZ,CAAyB,GAAzB,EAA8B,eAA9B,EAA+C,EAA/C,EAAmD,UAAU,GAAV,EAAe,WAAf,EAA4B,SAA5B,EAAuC;;AAEtF,YAAI,UAAW,CAAC,GAAD,GAAO,WAAW,YAAY,IAAvB,GAA8B,GAA9B,GAAoC,UAAU,GAArD,GAA2D,SAA1E;AACA,YAAI,UAAU;AACV,4BAAgB,YADN;AAEV,oCAAwB,KAAK,MAAL,CAAY,MAAZ,CAAmB,WAAnB,EAAgC,SAAhC,EAA2C,EAAE,SAAS,OAAX,EAAoB,aAAa,YAAjC,EAA3C;AAFd,SAAd;;AAKA,YAAI,SAAJ,CAAc,CAAC,GAAD,GAAO,GAAP,GAAa,GAA3B,EAAgC,OAAhC;AACA,YAAI,GAAJ,CAAQ,OAAR;AACH,KAVD;AAWH,CAbD;;AAeA,KAAK,YAAL,CAAkB,OAAlB,EAA2B,MAA3B,CAAkC,IAAlC,EAAwC,WAAxC;;;;AAKA,QAAQ,0CAAR,EAAoD,UAAU,KAAV,EAAiB,QAAjB,EAA2B,IAA3B,EAAiC;;AAEjF,YAAQ,GAAR,CAAY,SAAS,UAAT,GAAsB,IAAtB,GAA6B,IAAzC;AACH,CAHD;;;;AAQA,gBAAgB,cAAhB,EAAgC,UAAU,GAAV,EAAe,WAAf,EAA4B;;AAExD,QAAI,SAAS,KAAK,MAAL,CAAY,MAAZ,CAAmB,0CAAnB,EAA+D,KAA/D,EAAsE,EAAE,aAAa,WAAf,EAA4B,KAAK,cAAjC,EAAtE,CAAb;AACA,QAAI,UAAU;AACV,aAAK,0CADK;AAEV,gBAAQ,KAFE;AAGV,iBAAS;AACL,2BAAe,OAAO;AADjB;AAHC,KAAd;;AAQA,YAAQ,OAAR,EAAiB,UAAU,KAAV,EAAiB,QAAjB,EAA2B,IAA3B,EAAiC;;AAE9C,YAAI,UAAU,KAAK,MAAL,CAAY,YAAZ,CAAyB,QAAzB,EAAmC,WAAnC,EAAgD,OAAO,SAAvD,EAAkE,EAAE,SAAS,IAAX,EAAlE,CAAd;AACA,gBAAQ,GAAR,CAAY,SAAS,UAAT,GAAsB,IAAtB,GAA6B,IAA7B,IAAqC,UAAU,UAAV,GAAuB,YAA5D,CAAZ;AACA,gBAAQ,IAAR,CAAa,CAAb;AACH,KALD;AAMH,CAjBD","file":"usage-compiled.js","sourcesContent":["// Load modules\r\n\r\nvar Http = require('http');\r\nvar Request = require('request');\r\nvar Hawk = require('../lib');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {\r\n    credentials: {\r\n        dh37fgj492je: {\r\n            id: 'dh37fgj492je',                                             // Required by Hawk.client.header\r\n            key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n            algorithm: 'sha256',\r\n            user: 'Steve'\r\n        }\r\n    }\r\n};\r\n\r\n\r\n// Credentials lookup function\r\n\r\nvar credentialsFunc = function (id, callback) {\r\n\r\n    return callback(null, internals.credentials[id]);\r\n};\r\n\r\n\r\n// Create HTTP server\r\n\r\nvar handler = function (req, res) {\r\n\r\n    Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials, artifacts) {\r\n\r\n        var payload = (!err ? 'Hello ' + credentials.user + ' ' + artifacts.ext : 'Shoosh!');\r\n        var headers = {\r\n            'Content-Type': 'text/plain',\r\n            'Server-Authorization': Hawk.server.header(credentials, artifacts, { payload: payload, contentType: 'text/plain' })\r\n        };\r\n\r\n        res.writeHead(!err ? 200 : 401, headers);\r\n        res.end(payload);\r\n    });\r\n};\r\n\r\nHttp.createServer(handler).listen(8000, '127.0.0.1');\r\n\r\n\r\n// Send unauthenticated request\r\n\r\nRequest('http://127.0.0.1:8000/resource/1?b=1&a=2', function (error, response, body) {\r\n\r\n    console.log(response.statusCode + ': ' + body);\r\n});\r\n\r\n\r\n// Send authenticated request\r\n\r\ncredentialsFunc('dh37fgj492je', function (err, credentials) {\r\n\r\n    var header = Hawk.client.header('http://127.0.0.1:8000/resource/1?b=1&a=2', 'GET', { credentials: credentials, ext: 'and welcome!' });\r\n    var options = {\r\n        uri: 'http://127.0.0.1:8000/resource/1?b=1&a=2',\r\n        method: 'GET',\r\n        headers: {\r\n            authorization: header.field\r\n        }\r\n    };\r\n\r\n    Request(options, function (error, response, body) {\r\n\r\n        var isValid = Hawk.client.authenticate(response, credentials, header.artifacts, { payload: body });\r\n        console.log(response.statusCode + ': ' + body + (isValid ? ' (valid)' : ' (invalid)'));\r\n        process.exit(0);\r\n    });\r\n});\r\n\r\n"]}