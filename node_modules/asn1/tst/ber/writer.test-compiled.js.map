{"version":3,"sources":["writer.test.js"],"names":[],"mappings":"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","file":"writer.test-compiled.js","sourcesContent":["// Copyright 2011 Mark Cavage <mcavage@gmail.com> All rights reserved.\n\nvar test = require('tap').test;\nvar sys = require('sys');\n\n///--- Globals\n\nvar BerWriter;\n\nvar BerReader;\n\n\n///--- Tests\n\ntest('load library', function(t) {\n  BerWriter = require('../../lib/index').BerWriter;\n  t.ok(BerWriter);\n  t.ok(new BerWriter());\n  t.end();\n});\n\n\ntest('write byte', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeByte(0xC2);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 1, 'Wrong length');\n  t.equal(ber[0], 0xC2, 'value wrong');\n\n  t.end();\n});\n\n\ntest('write 1 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7f);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 3, 'Wrong length for an int: ' + ber.length);\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong (2) -> ' + ber[0]);\n  t.equal(ber[1], 0x01, 'length wrong(1) -> ' + ber[1]);\n  t.equal(ber[2], 0x7f, 'value wrong(3) -> ' + ber[2]);\n\n  t.end();\n});\n\n\ntest('write 2 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7ffe);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 4, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x02, 'length wrong');\n  t.equal(ber[2], 0x7f, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xfe, 'value wrong (byte 2)');\n\n  t.end();\n});\n\n\ntest('write 3 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7ffffe);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 5, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x03, 'length wrong');\n  t.equal(ber[2], 0x7f, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xff, 'value wrong (byte 2)');\n  t.equal(ber[4], 0xfe, 'value wrong (byte 3)');\n\n  t.end();\n});\n\n\ntest('write 4 byte int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(0x7ffffffe);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 6, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x04, 'length wrong');\n  t.equal(ber[2], 0x7f, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xff, 'value wrong (byte 2)');\n  t.equal(ber[4], 0xff, 'value wrong (byte 3)');\n  t.equal(ber[5], 0xfe, 'value wrong (byte 4)');\n\n  t.end();\n});\n\n\ntest('write 1 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-128);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 3, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x01, 'length wrong');\n  t.equal(ber[2], 0x80, 'value wrong (byte 1)');\n\n  t.end();\n});\n\n\ntest('write 2 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-22400);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 4, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x02, 'length wrong');\n  t.equal(ber[2], 0xa8, 'value wrong (byte 1)');\n  t.equal(ber[3], 0x80, 'value wrong (byte 2)');\n\n  t.end();\n});\n\n\ntest('write 3 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-481653);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 5, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x03, 'length wrong');\n  t.equal(ber[2], 0xf8, 'value wrong (byte 1)');\n  t.equal(ber[3], 0xa6, 'value wrong (byte 2)');\n  t.equal(ber[4], 0x8b, 'value wrong (byte 3)');\n\n  t.end();\n});\n\n\ntest('write 4 byte negative int', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeInt(-1522904131);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 6, 'Wrong length for an int');\n  t.equal(ber[0], 0x02, 'ASN.1 tag wrong');\n  t.equal(ber[1], 0x04, 'length wrong');\n  t.equal(ber[2], 0xa5, 'value wrong (byte 1)');\n  t.equal(ber[3], 0x3a, 'value wrong (byte 2)');\n  t.equal(ber[4], 0x53, 'value wrong (byte 3)');\n  t.equal(ber[5], 0xbd, 'value wrong (byte 4)');\n\n  t.end();\n});\n\n\ntest('write boolean', function(t) {\n  var writer = new BerWriter();\n\n  writer.writeBoolean(true);\n  writer.writeBoolean(false);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 6, 'Wrong length');\n  t.equal(ber[0], 0x01, 'tag wrong');\n  t.equal(ber[1], 0x01, 'length wrong');\n  t.equal(ber[2], 0xff, 'value wrong');\n  t.equal(ber[3], 0x01, 'tag wrong');\n  t.equal(ber[4], 0x01, 'length wrong');\n  t.equal(ber[5], 0x00, 'value wrong');\n\n  t.end();\n});\n\n\ntest('write string', function(t) {\n  var writer = new BerWriter();\n  writer.writeString('hello world');\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 13, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\ntest('write buffer', function(t) {\n  var writer = new BerWriter();\n  // write some stuff to start with\n  writer.writeString('hello world');\n  var ber = writer.buffer;\n  var buf = new Buffer([0x04, 0x0b, 0x30, 0x09, 0x02, 0x01, 0x0f, 0x01, 0x01,\n     0xff, 0x01, 0x01, 0xff]);\n  writer.writeBuffer(buf.slice(2, buf.length), 0x04);\n  ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 26, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2, 13).toString('utf8'), 'hello world', 'wrong value');\n  t.equal(ber[13], buf[0], 'wrong tag');\n  t.equal(ber[14], buf[1], 'wrong length');\n  for (var i = 13, j = 0; i < ber.length && j < buf.length; i++, j++) {\n    t.equal(ber[i], buf[j], 'buffer contents not identical');\n  }\n  t.end();\n});\n\ntest('write string array', function(t) {\n  var writer = new BerWriter();\n  writer.writeStringArray(['hello world', 'fubar!']);\n  var ber = writer.buffer;\n\n  t.ok(ber);\n\n  t.equal(ber.length, 21, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2, 13).toString('utf8'), 'hello world', 'wrong value');\n\n  t.equal(ber[13], 0x04, 'wrong tag');\n  t.equal(ber[14], 6, 'wrong length');\n  t.equal(ber.slice(15).toString('utf8'), 'fubar!', 'wrong value');\n\n  t.end();\n});\n\n\ntest('resize internal buffer', function(t) {\n  var writer = new BerWriter({size: 2});\n  writer.writeString('hello world');\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 13, 'wrong length');\n  t.equal(ber[0], 0x04, 'wrong tag');\n  t.equal(ber[1], 11, 'wrong length');\n  t.equal(ber.slice(2).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\n\ntest('sequence', function(t) {\n  var writer = new BerWriter({size: 25});\n  writer.startSequence();\n  writer.writeString('hello world');\n  writer.endSequence();\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  console.log(ber);\n  t.equal(ber.length, 15, 'wrong length');\n  t.equal(ber[0], 0x30, 'wrong tag');\n  t.equal(ber[1], 13, 'wrong length');\n  t.equal(ber[2], 0x04, 'wrong tag');\n  t.equal(ber[3], 11, 'wrong length');\n  t.equal(ber.slice(4).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\n\ntest('nested sequence', function(t) {\n  var writer = new BerWriter({size: 25});\n  writer.startSequence();\n  writer.writeString('hello world');\n  writer.startSequence();\n  writer.writeString('hello world');\n  writer.endSequence();\n  writer.endSequence();\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 30, 'wrong length');\n  t.equal(ber[0], 0x30, 'wrong tag');\n  t.equal(ber[1], 28, 'wrong length');\n  t.equal(ber[2], 0x04, 'wrong tag');\n  t.equal(ber[3], 11, 'wrong length');\n  t.equal(ber.slice(4, 15).toString('utf8'), 'hello world', 'wrong value');\n  t.equal(ber[15], 0x30, 'wrong tag');\n  t.equal(ber[16], 13, 'wrong length');\n  t.equal(ber[17], 0x04, 'wrong tag');\n  t.equal(ber[18], 11, 'wrong length');\n  t.equal(ber.slice(19, 30).toString('utf8'), 'hello world', 'wrong value');\n\n  t.end();\n});\n\n\ntest('LDAP bind message', function(t) {\n  var dn = 'cn=foo,ou=unit,o=test';\n  var writer = new BerWriter();\n  writer.startSequence();\n  writer.writeInt(3);             // msgid = 3\n  writer.startSequence(0x60);     // ldap bind\n  writer.writeInt(3);             // ldap v3\n  writer.writeString(dn);\n  writer.writeByte(0x80);\n  writer.writeByte(0x00);\n  writer.endSequence();\n  writer.endSequence();\n  var ber = writer.buffer;\n\n  t.ok(ber);\n  t.equal(ber.length, 35, 'wrong length (buffer)');\n  t.equal(ber[0], 0x30, 'wrong tag');\n  t.equal(ber[1], 33, 'wrong length');\n  t.equal(ber[2], 0x02, 'wrong tag');\n  t.equal(ber[3], 1, 'wrong length');\n  t.equal(ber[4], 0x03, 'wrong value');\n  t.equal(ber[5], 0x60, 'wrong tag');\n  t.equal(ber[6], 28, 'wrong length');\n  t.equal(ber[7], 0x02, 'wrong tag');\n  t.equal(ber[8], 1, 'wrong length');\n  t.equal(ber[9], 0x03, 'wrong value');\n  t.equal(ber[10], 0x04, 'wrong tag');\n  t.equal(ber[11], dn.length, 'wrong length');\n  t.equal(ber.slice(12, 33).toString('utf8'), dn, 'wrong value');\n  t.equal(ber[33], 0x80, 'wrong tag');\n  t.equal(ber[34], 0x00, 'wrong len');\n\n  t.end();\n});\n\n\ntest('Write OID', function(t) {\n  var oid = '1.2.840.113549.1.1.1';\n  var writer = new BerWriter();\n  writer.writeOID(oid);\n\n  var ber = writer.buffer;\n  t.ok(ber);\n  console.log(require('util').inspect(ber));\n  console.log(require('util').inspect(new Buffer([0x06, 0x09, 0x2a, 0x86,\n                                                  0x48, 0x86, 0xf7, 0x0d,\n                                                  0x01, 0x01, 0x01])));\n\n  t.end();\n});\n"]}